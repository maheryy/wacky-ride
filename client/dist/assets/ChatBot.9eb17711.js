import{f as h,o,c as i,a as s,p as c,k as d,F as g,z as x,A as f,q as k,j as $,v as m,_ as C,G as y,x as _,m as E,r as S,b,w as M,d as V,D as O,C as A,s as I,t as q}from"./index.4ddf9c97.js";var r=(e=>(e.BOOLEAN="boolean",e.DATE="date",e.NUMBER="number",e.CHOICES="choices",e.NONE="none",e.QUIT="quit",e.TEXT="text",e))(r||{});const U={class:"chat-bot__action"},T={key:0},D={key:1},L={key:2},P={key:3},R={key:4},F=["onClick"],H=h({__name:"ChatBotAction",props:{action:null,dispatch:null},setup(e){const t={};return(l,n)=>(o(),i("div",U,[s("form",{onSubmit:n[8]||(n[8]=$(()=>{},["prevent"]))},[e.action.type===c(r).TEXT?(o(),i("div",T,[d(s("input",{type:"text",name:"text","onUpdate:modelValue":n[0]||(n[0]=a=>t.text=a),required:""},null,512),[[m,t.text]]),s("button",{onClick:n[1]||(n[1]=a=>{t.text&&e.dispatch({value:t.text,label:t.text}),t.text=null})}," Valider ")])):e.action.type===c(r).NUMBER?(o(),i("div",D,[d(s("input",{type:"number",name:"number","onUpdate:modelValue":n[2]||(n[2]=a=>t.number=a),required:""},null,512),[[m,t.number]]),s("button",{onClick:n[3]||(n[3]=a=>{t.number&&e.dispatch({value:t.number,label:t.number}),t.number=null})}," Valider ")])):e.action.type===c(r).DATE?(o(),i("div",L,[d(s("input",{type:"date",name:"date","onUpdate:modelValue":n[4]||(n[4]=a=>t.date=a),required:""},null,512),[[m,t.date]]),s("button",{onClick:n[5]||(n[5]=a=>{t.date&&e.dispatch({value:t.date,label:t.date}),t.date=null})}," Valider ")])):e.action.type===c(r).BOOLEAN?(o(),i("div",P,[s("button",{name:"boolean",onClick:n[6]||(n[6]=a=>e.dispatch({value:"yes",label:"Oui"}))}," Oui "),s("button",{name:"boolean",onClick:n[7]||(n[7]=a=>e.dispatch({value:"no",label:"Non"}))}," Non ")])):e.action.type===c(r).CHOICES?(o(),i("div",R,[(o(!0),i(g,null,x(e.action.payload,a=>(o(),i("button",{name:"choices",onClick:p=>e.dispatch({value:a.value,label:a.label})},f(a.label),9,F))),256))])):k("",!0)],32)]))}});const X=C(H,[["__scopeId","data-v-5196d9ea"]]),j={class:"message"},z={class:"message__content"},G={key:0,class:"message__meta"},Q=s("span",{class:"message__meta__user"},"Wacky bot",-1),J=[Q],K=h({__name:"ChatBotMessage",props:{message:null},setup(e){return(t,l)=>(o(),i("li",j,[s("div",z,f(e.message.content),1),e.message.isBotMessage?(o(),i("div",G,J)):k("",!0)]))}});class Y{async init(){const t=await this.fetchStep("workflow");return t?(this.current=t,!0):!1}async next(t){const l=await this.requestNext(t);if(!l)return!1;const n=await this.fetchStep(l);return n?(this.current=n,!0):!1}async requestNext(t){try{return(await y.post(this.path,{params:t})).data.next}catch{return null}}async fetchStep(t){this.path=t;try{return(await y.get(this.path)).data}catch{return null}}getActionPayload(){return this.current.payload}hasActionPayload(){return!!this.current.payload}getActionType(){return this.current.action}getMessage(){return this.current.message}}const Z=e=>(I("data-v-14618330"),e=e(),q(),e),W={class:"main-container wacky-tile"},tt={id:"chat-bot",class:"community"},et=Z(()=>s("h3",null,"Wacky bot",-1)),nt=h({__name:"ChatBot",setup(e){const t=_([]),l=_({type:r.NONE}),n=_(null);let a;const p=async u=>{await a.next([u.value])&&(t.value.push({isBotMessage:!1,content:u.label.toString()}),v())},v=async()=>{var u;t.value.push({isBotMessage:!0,content:a.getMessage()}),await A(),(u=n.value)==null||u.scrollIntoView({block:"end"}),l.value={type:a.getActionType(),...a.hasActionPayload()?{payload:a.getActionPayload()}:{}}};return E(async()=>{a=new Y,await a.init()&&v()}),(u,at)=>{const B=S("RouterLink");return o(),i("div",W,[s("section",tt,[s("header",null,[b(B,{to:"/community",class:"back"},{default:M(()=>[V("\u1438")]),_:1}),et]),s("ul",null,[(o(!0),i(g,null,x(t.value,(w,N)=>(o(),O(K,{key:N,message:w},null,8,["message"]))),128)),s("div",{ref_key:"bottom",ref:n},null,512)]),b(X,{action:l.value,dispatch:p},null,8,["action"])])])}}});const ot=C(nt,[["__scopeId","data-v-14618330"]]);export{ot as default};
